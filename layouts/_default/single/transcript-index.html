{{ .Render "global/header" }}
{{ .Render "global/main" }}

{{ $pagedate := $.Page.Date.Format "2006" }}
{{ $thisdate := now.Format "2006" }}
{{ $tags     := slice $pagedate }}

{{ $inter_pages    := where .Site.Pages.ByDate "Layout" "transcript" }}
{{ $inter_articles := where $inter_pages "Params.interviewurl" "ne" nil }}
{{ $inter_year     := where $inter_articles ".Params.interviewyear" "eq" $pagedate }}

{{ $len := len $inter_year }}

{{ if and (ne $len 0) (ne .Params.type "main") }}<p>There {{ if gt $len 1 }}are{{ else }}is{{ end }} {{ $len }} transcript{{ if gt $len 1 }}s{{ end }} from {{ $pagedate }}.<p>{{ end }}

<table class="table table-striped table-borderless table-hover table-transcripts">

    <thead class="table-success">
        <tr>
            <th scope="col" width="30%">Date ({{ $pagedate }})</th>
            <th scope="col" width="70%">Source</th>
        </tr>
    </thead>

    <tbody>
        {{ if eq $len 0 }}
            <tr>
                <td colspan="2">There are no transcripts for {{ $pagedate }} yet.</td>
            </tr>
        {{ else if eq .Params.type "main" }}
            {{ range first 5 $inter_year.Reverse }}
                <tr>
                    <td>{{ .Date.Format "02 January" }}, {{ $pagedate }}</td>
                    <td><a href="{{ .Permalink }}">{{ htmlUnescape .Title }}</a></td>
                </tr>
            {{ end }}
        {{ else }}
            {{ range $inter_year }}
                <tr>
                    <td>{{ .Date.Format "January 02" }}</td>
                    <td>
                        <a href="{{ .Permalink }}">{{ htmlUnescape .Title }}</a>
                        {{ if not .Lastmod.IsZero }}
                            <script>
                                // Current Date
                                var pubdate = new Date( {{ .Date }} );
                                var nowdate = new Date();
                                var diff    = parseInt( ( nowdate.getTime() - pubdate.getTime() ) / ( 1000 * 60  * 60 * 24 ) );

                                if ( diff <= 30 ) {
                                    document.write( "<span class='badge rounded-pill bg-success'>NEW!</span>" );
                                }
                            </script>
                        {{ end }}
                    </td>
                </tr>
            {{ end }}
        {{ end }}
    </tbody>

    <tfoot class="table-success">
        <tr>
            <th scope="col" width="30%">Date</th>
            <th scope="col" width="70%">Source</th>
        </tr>
    </tfoot>
</table>
